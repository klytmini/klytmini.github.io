function extractNumber(t){t=t.match(/^A(\d+)$/);return t?t[1]:null}function checkNumberInRange(t){return 101<=t&&t<=118||301<=t&&t<=318}function checkEmoji(t){return checkNumberInRange(extractNumber(t))}function runWithCatch(t){try{t()}catch(t){console.log("发生了一个错误：",t)}}function setDefaultValue(t,e,n){return t&&t.hasOwnProperty(e)?t[e]:n}function loadProfile(e){runWithCatch(()=>{$(".photo").empty()}),runWithCatch(()=>{$(".head").attr("src",`https://res.mimeng.fun/role/${e?.RoleInfo?.head_id}.png`)}),runWithCatch(()=>{loadImageWithFallback(`https://res.mimeng.fun/headframe/${setDefaultValue(e,"head_frame_id",0)}.gif`,"png",$(".head-frame"))}),runWithCatch(()=>{0===e?.RoleInfo?.HasAvatar&&null!=e?.header&&$(".head").attr("src",e.header.url)}),runWithCatch(()=>{$(".Model").attr("src",`https://res.mimeng.fun/role/${e?.RoleInfo?.Model}.png`)}),runWithCatch(()=>{$(".NickName").text(e?.RoleInfo?.NickName)}),runWithCatch(()=>{$(".uin").text(e?.uin||"账号被删除")}),runWithCatch(()=>{checkEmoji(setDefaultValue(e,"mood_icon","A100"))?$(".mood_icon").attr("src",`https://res.mimeng.fun/emoji/${e.mood_icon}.png`):$(".mood_icon").attr("src","")}),runWithCatch(()=>{$(".mood_text").text(e?.mood_text||"无")}),runWithCatch(()=>{$(".friend_toapply").text(setDefaultValue(e?.relation,"friend_toapply",0))}),runWithCatch(()=>{$(".friend_beattention").text(setDefaultValue(e?.relation,"friend_beattention",0))}),runWithCatch(()=>{$(".friend_beapply").text(setDefaultValue(e?.relation,"friend_beapply",0))}),runWithCatch(()=>{$(".friend_oneway").text(setDefaultValue(e?.relation,"friend_oneway",0))}),runWithCatch(()=>{$(".friend_eachother").text(setDefaultValue(e?.relation,"friend_eachother",0))}),runWithCatch(()=>{$(".friend_attention").text(setDefaultValue(e?.relation,"friend_attention",0))}),runWithCatch(()=>{$(".stat").text(["否","是"][setDefaultValue(e?.creator,"stat",0)])}),runWithCatch(()=>{$(".level").text(setDefaultValue(e?.creator,"level",0))}),runWithCatch(()=>{$(".all_download_count").text(setDefaultValue(e,"all_download_count",0))}),runWithCatch(()=>{for(var t in e?.photo)$(".photo").append(`<img src="${e.photo[t].url}" />`)}),runWithCatch(()=>{$(".lang").text(setDefaultValue(e,"lang","简体中文"))}),runWithCatch(()=>{$(".country").text(setDefaultValue(e,"country","CN"))})}function parseProfile(t){0==t.ret?(loading.close(),void 0===t.profile.RoleInfo?Qmsg.error("玩家不存在！"):(Qmsg.success("查询成功！"),loadProfile(t.profile))):(loading.close(),Qmsg.error("查询失败！"))}function loadMaps(t){for(i in t.map_info_list)$(".maps").append(`
        <div class="card">
        <a href="https://h5.mini1.cn/activity/shareH5Map/mapDetails/index.html?type=open_maproom_desc&zb_wid=${i}" target="_blank"><div class="title">${t.map_info_list[i].name}</div></a>
            <div class="tag-b">${t.map_info_list[i].memo}</div>
            <div class="photo"><img src="https://map${t.map_info_list[i].node}.mini1.cn/map/${t.map_info_list[i].node}/${t.map_info_list[i].dir}/${t.map_info_list[i].thumb_md5}.png" /></div>
        </div>`)}function parseMaps(t){$(".maps").empty(),"{}"!=JSON.stringify()&&loadMaps(t)}function getProfile(t){fetch("/api/getProfile?uid="+t).then(t=>t.json()).then(t=>{parseProfile(t.profile),parseMaps(t.userMaps)}).catch(t=>{loading.close(),Qmsg.error("查询失败"),console.error("Error retrieving profile data:",t)}).finally(()=>{isSubmiting=!1})}function loadImageWithFallback(e,n,a){const t=new Image;t.src=e,t.onload=function(){a.attr("src",t.src)},t.onerror=function(){const t=new Image;t.src=e.replace(/\.\w+$/,"."+n),t.onload=function(){a.attr("src",t.src)},t.onerror=function(){a.attr("src","")}}}updateCount(8,"times",1),Qmsg.config({showClose:!1,timeout:1500,html:!0}),isSubmiting=!1,$("#search-button").click(function(){isSubmiting?Qmsg.warning("请勿频繁请求！"):(isSubmiting=!0,0!=(searchID=Number($("#search-input").children().val()))?(loading=Qmsg.loading("正在查询中..."),getProfile(searchID)):Qmsg.warning("请输入迷你号！"))}),$("#search-input").submit(function(t){return isSubmiting?Qmsg.warning("请勿频繁请求！"):(isSubmiting=!0,0!=(searchID=Number($("#search-input").children().val()))?(loading=Qmsg.loading("正在查询中..."),getProfile(searchID)):Qmsg.warning("请输入迷你号！")),!1});